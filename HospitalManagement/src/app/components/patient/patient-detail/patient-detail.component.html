<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <button (click)="printToken()" class="btn btn-info mb-3">Print</button>

      <div *ngIf="errorMessage" class="alert alert-danger shadow-sm" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i> {{ errorMessage }}
      </div>

      <div *ngIf="!patient && !errorMessage" class="card shadow-sm border-warning">
        <div class="card-body d-flex justify-content-center py-5">
          <div class="spinner-border text-warning me-3" role="status">
            <span class="visually-hidden">Loading patient details...</span>
          </div>
          <p class="mb-0 text-warning">Loading patient details...</p>
        </div>
      </div>

      <div *ngIf="patient" class="card shadow-lg border-0 rounded-3">
        <div class="card-header bg-gradient text-white py-3 rounded-top" style="background-color: #007bff">
          <h5 class="mb-0">
            <i class="bi bi-person-vcard-fill me-2"></i> Patient Profile
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6 border-end">
              <h6 class="card-subtitle mb-3 text-primary">
                <i class="bi bi-person-lines-fill me-2"></i> Patient Information
              </h6>
              <dl class="row">
                <!-- <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-tag me-1"></i> Patient ID:
                </dt>
                <dd class="col-sm-8 text-muted">{{ patient.patientId }}</dd> -->

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-hash me-1"></i> Patient No:
                </dt>
                <dd class="col-sm-8 text-muted">{{ patient.patientNo }}</dd>

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-person-fill me-1"></i> Patient Name:
                </dt>
                <dd class="col-sm-8 text-muted">{{ patient.firstName }} {{ patient.lastName }}</dd>

                <!-- <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-person-fill me-1"></i> Last Name:
                </dt>
                <dd class="col-sm-8 text-muted">{{ patient.lastName }}</dd> -->

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-passport-fill me-1"></i> Registration ID:
                </dt>
                <dd class="col-sm-8 text-muted">
                  {{ patient.registrationId || "N/A" }}
                </dd>

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-gender-ambiguous me-1"></i> Gender:
                </dt>
                <dd class="col-sm-8 text-muted">{{ patient.gender }}</dd>

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-calendar-heart-fill me-1"></i> Age:
                </dt>
                <dd class="col-sm-8 text-muted">{{ patient.age }}</dd>

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-calendar-check-fill me-1"></i> First Visit:
                </dt>
                <dd class="col-sm-8 text-muted">
                  {{ formatDate(patient.firstVisitDate) || "N/A" }}
                </dd>

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-hospital-fill me-1"></i> Patient Type:
                </dt>
                <dd class="col-sm-8">
                  <span class="badge bg-primary">{{
                    patient.patientType
                    }}</span>
                </dd>

                <dt class="col-sm-4 fw-bold text-secondary">
                  <i class="bi bi-list-check me-1"></i> Visit Type:
                </dt>
                <dd class="col-sm-8 text-muted">
                  {{ patient.visitType || "N/A" }}
                </dd>
              </dl>
            </div>
            <div class="col-md-6 py-3 py-md-0">
              <h6 class="card-subtitle mb-3 text-success">
                <i class="bi bi-ticket-fill me-2"></i> Latest Token
              </h6>
              <div *ngIf="patient.token; else noToken">
                <dl class="row">
                  <dt class="col-sm-4 fw-bold text-secondary">
                    <i class="bi bi-ticket me-1"></i> Token Number:
                  </dt>
                  <dd class="col-sm-8 text-muted">
                    {{ patient.token.tokenNumber }}
                  </dd>

                  <dt class="col-sm-4 fw-bold text-secondary">
                    <i class="bi bi-cash-coin me-1"></i> Token Fee:
                  </dt>
                  <dd class="col-sm-8 text-muted">
                    {{ patient.token.tokenFee }}
                  </dd>
                </dl>
              </div>
              <ng-template #noToken>
                <p class="text-muted">
                  <i class="bi bi-slash-circle-fill me-2"></i> No token issued
                  yet for this patient.
                </p>
              </ng-template>
            </div>
          </div>
        </div>
        <div class="card-footer bg-light py-3 d-flex justify-content-end gap-2 rounded-bottom">
          <button class="btn btn-outline-secondary btn-sm" [routerLink]="['/patients']">
            <i class="bi bi-arrow-left me-1"></i> Back
          </button>
          <button class="btn btn-primary btn-sm" [routerLink]="['/patients/edit', patient.patientId]">
            <i class="bi bi-pencil-fill me-1"></i> Edit
          </button>
        </div>
      </div>
    </div>
  </div>
</div>